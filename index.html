<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="main.css" type="text/css"></script>
    <title>The Cube</title>
</head>
    <body style="height: 100%; margin: 0px">
        <script src="js/three.js"></script>
        <script>
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 1, 1000 );

            var renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );


            var directionalLight = new THREE.DirectionalLight( 0xffffff, 20 );
            directionalLight.position.set( 25, 25, 25 );
            directionalLight.decay = 10;


            var geometry = new THREE.BoxBufferGeometry( 1, 1, 1 );
            //var curvyBoi = new THREE.TorusKnotBufferGeometry( 10, 3, 100,  16 );
            var curvyBoi = new THREE.TorusKnotBufferGeometry( 1, 0.25, 180, 20 );

            var material = new THREE.MeshPhongMaterial( { color: 0x050b, side: THREE.FrontSide } );
            var materialLemon = new THREE.MeshPhongMaterial( { color: 0x1e7f01, side: THREE.FrontSide } );
            //var material = new THREE.MeshBasicMaterial( { color: 0x04db}  );
            var cube = new THREE.Mesh( geometry, material);
            var cube2 = new THREE.Mesh(geometry, material);
            var knot = new THREE.Mesh(curvyBoi, materialLemon);

            scene.add( directionalLight );
            scene.add( cube );
            scene.add( knot );

            scene.add( cube2 );

            directionalLight.target = knot;

            camera.position.z = 5;
            camera.position.x = 2.5;

            knot.position.x = 2.5;
            cube2.position.x = 5;

            var leftCube = false;
            var leftCirc = false;
            var circFront = 1;

            var animate = function () {
                requestAnimationFrame( animate );

                cube.rotation.x += 0.01;
                cube.rotation.y += 0.01;

                cube2.rotation.x += 0.02;
                cube2.rotation.y += 0.02;

                knot.rotation.x += 0.01;
                knot.rotation.y += 0.01;

                //if(cube2.position.x >= 5) leftCube = true;
                //else if(cube2.position.x <= 0) leftCube = false;

                if(cube2.position.x > 4) {leftCirc = true; circFront *= -1}
                else if(cube2.position.x < 0) {leftCirc = false; circFront *= -1}

                if(leftCirc) cube2.position.x -= 0.01;
                else cube2.position.x += 0.01;

                cube2.position.z = Math.sqrt(4 - ((cube2.position.x-Math.sqrt(4)) * (cube2.position.x-Math.sqrt(4)))) * circFront;

                /*
                if(camera.position.x > 5.5) leftCirc = true;
                else if(camera.position.x < 0) leftCirc = false;

                if(leftCirc) camera.position.x -= 0.01;
                else camera.position.x += 0.01;

                camera.position.z = 3 - (camera.position.x * camera.position.x);
                */

                //if(leftCube)
                //{cube2.position.x -= 0.025; cube.position.x += 0.025;}
                //else {cube2.position.x += 0.025; cube.position.x -= 0.025;}

                renderer.render( scene, camera );
            };

            animate();
        </script>
    </body>
</html>